#!/bin/sh

# release test

# clean up build/dist directories
rm -rf ~/ipython/ipython/build/*
rm -rf ~/ipython/ipython/dist/*

# build source distros
cd ~/ipython/ipython

PYVER=`python -V 2>&1 | awk '{print $2}' | awk -F '.' '{print $1$2}' `

./setup.py sdist --formats=gztar
./setup.py bdist_rpm --release=py$PYVER
./setup.py bdist_wininst --install-script=ipython_win_post_install.py

# Fix the name in the win32 installer to add the python version to it
cd dist
rename win32.exe win32-py${PYVER}.exe *win32.exe
cd -

# To get a specific python in the spec file, we must fix it:
#python2.3 ./setup.py bdist_rpm --release=py23 --fix-python
